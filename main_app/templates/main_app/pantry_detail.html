{% extends 'base.html' %}
{% load static %}
{% load custom_tags %}

{% block head %}
  <link rel="stylesheet" href="{% static 'css/pantry_detail.css' %}" />
{% endblock %}

{% block content %}
  {% if pantry and user == pantry.owner %}
    <h1>{{ pantry.name }}</h1>
    <div class="flex-line">
      <form action="{% url 'pantry-update' pantry.pk %}" method="get">
        <button type="submit" class="btn">Edit</button>
      </form>
      <form action="{% url 'pantry-delete' pantry.pk %}">
        <button type="submit" class="btn warn">Delete</button>
      </form>
    </div>
    <div class="pantry-display">
      {% if pantry.items.all %}
        <ul class="pantry-item-list flex-row-wrap">
          {% for pantryitem in pantry.items.all %}
            <a href="{% url 'pantryitem-update' pantryitem.pk %}?next={{ request.path }}">
              <li class="card">
                {% if pantryitem.item.image %}
                  <img src="{{ pantryitem.item.image }}" alt="Image of {{ pantryitem.item.name }}" />
                {% endif %}
                <h3>{{ pantryitem.item.name }}</h3>
                {% if pantryitem.quanity == 1 %}
                  Qty. {{ pantryitem.quantity }} {{ pantryitem.unit }}
                {% else %}
                  Qty. {{ pantryitem.quantity }} {{ pantryitem.unit }}s
                {% endif %}
              </li>
            </a>
          {% endfor %}
        </ul>
      {% endif %}
      {% if pantry.items.all.count == 1 %}
        <p class="center-self">{{ pantry.items.all.count }} item</p>
      {% else %}
        <p class="center-self">{{ pantry.items.all.count }} items</p>
      {% endif %}
    </div>
    <div class="all-items">
      {% if items.count %}
        <h1 class="center-self">{{ user|upper }}'s Items</h1>
        <ul class="flex-row-wrap">
          {% for item in items %}
            <a href="{% url 'pantryitem-create' pantry.pk item.pk %}?next={{ request.path }}">
              <li class="card">
                {% if item.image %}
                  <img src="{{ item.image }}" alt="Image of {{ item.name }}" />
                {% endif %}
                <h2>{{ item.name }}</h2>
                {% if item.purchase_locations.all.count %}
                  <div class="flex-row-wrap">
                    <p>
                      <small>{{ item.purchase_locations.all|join_names:', ' }}</small>
                    </p>
                  </div>
                {% endif %}
              </li>
            </a>
          {% endfor %}
        </ul>
      {% endif %}
    </div>
  {% else %}
    <h1>No Pantry at this address</h1>
  {% endif %}
{% endblock %}
